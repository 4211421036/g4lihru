let callbackFunction=null;function createElement(e,t){const n=document.createElement(e);return void 0===t||(t.className&&(n.className=t.className),t.content&&(n.textContent=t.content),t.style&&(n.style=t.style),t.children&&t.children.forEach((e=>!e||n.appendChild(e)))),n}function createExpandedElement(e){const t=createElement("i");e.expanded?t.className="fas fa-caret-down":t.className="fas fa-caret-right";const n=createElement("recis-root-line",{style:"width: 18px; text-align: center; cursor: pointer",children:[t]}),r=e.toggle.bind(e);n.addEventListener("click",r);const c=createElement("recis-line",{className:"json json-index",content:e.key});c.addEventListener("click",r);const l=createElement("recis-line",{className:"json json-type",content:e.type}),a=createElement("recis-line",{className:"json json-key",content:e.key});a.addEventListener("click",r);const s=createElement("recis-line",{className:"json json-size"});if(s.addEventListener("click",r),"array"===e.type)s.innerText=`[${e.children.length} items]`;else if("object"===e.type){const t=e.children.find((e=>"size"===e.key));s.innerText=t?`{${t.value.toLocaleString()} bytes}`:`{${e.children.length} properties}`}let i;i=null===e.key?[n,l,s]:"array"===e.parent.type?[n,c,s]:[n,a,s];const o=createElement("recis-line",{className:"json-line",children:i});return e.depth>0&&(o.style=`margin-left: ${24*e.depth}px;`),o}function createNotExpandedElement(e){const t=createElement("recis-line",{style:"width: 18px"}),n=createElement("recis-line",{className:"json json-key",content:e.key}),r=createElement("recis-line",{className:"json-separator",content:":"}),c=createElement("recis-line",{className:`json json-value${" json-"+typeof e.value}`,content:e.value.toLocaleString()}),l=createElement("recis-line",{className:"json-line",children:[t,n,r,c]});return e.depth>0&&(l.style=`margin-left: ${24*e.depth}px;`),l}function createNode(){return{key:"",parent:{},value:null,expanded:!1,type:"",children:[],elem:{},depth:0,hideChildren(){Array.isArray(this.children)&&this.children.forEach((e=>{e.elem.classList.add("hide"),e.expanded&&e.hideChildren()}))},showChildren(){Array.isArray(this.children)&&this.children.forEach((e=>{e.elem.classList.remove("hide"),e.expanded&&e.showChildren()}))},toggle(){if(this.expanded){this.hideChildren();const e=this.elem?.querySelector(".fas");e.classList.replace("fa-caret-down","fa-caret-right"),null!==callbackFunction&&callbackFunction(null)}else{this.showChildren();const e=this.elem?.querySelector(".fas");e.classList.replace("fa-caret-right","fa-caret-down"),"object"===this.type&&null!==callbackFunction&&callbackFunction(`${this.parent?.key}/${this.key}`)}this.expanded=!this.expanded}}}function getType(e){let t;return t=Array.isArray(e)?"array":null===e?"null":typeof e,t}function traverseObject(e,t,n){for(const r in e){const c=createNode();if(c.parent=t,c.key=r,c.type=getType(e[r]),c.depth=t.depth+1,c.expanded=!1,Array.isArray(n))for(const e of n)if(r===e)return;"object"==typeof e[r]?(c.children=[],t.children.push(c),traverseObject(e[r],c,n),c.elem=createExpandedElement(c)):(c.value=e[r],c.elem=createNotExpandedElement(c),t.children.push(c))}}function createTree(e,t,n){const r=createNode();return r.type=t,r.key=t,r.children=[],r.expanded=!0,traverseObject(e,r,n),r.elem=createExpandedElement(r),r}function traverseTree(e,t){t(e),null!==e.children&&e.children.forEach((e=>traverseTree(e,t)))}async function jsonView(e,t,n="",r=[]){traverseTree(createTree(e,n,r),(e=>{e.expanded||e.hideChildren(),t.appendChild(e.elem)}))}export default jsonView;
